
**Дата:** 12 ноября 2024 г.

**Статус:** Принято

**Контекст:**

Для сервиса аренды автомобилей требуется выбрать систему хранения данных, учитывая разнообразные типы данных и требования к их обработке. Платформа должна поддерживать транзакционные операции, обеспечивать высокую производительность (PER02), масштабируемость (SCA01, SCA02) и гибкость для различных сценариев использования, включая хранение пользовательских данных, бронирований, отзывов и информации о транспортных средствах. Учитывая это, возможно использование комбинации SQL и NoSQL решений.

**Рассмотренные варианты:**

- **SQL:**
1. **PostgreSQL:** Объектно-реляционная система управления базами данных, подходит для хранения структурированных данных, таких как информация о пользователях, бронированиях, платежах и отзывах. [PER02, SCA01]
2. **MySQL:** Производительная реляционная СУБД, известная своей скоростью и широким распространением. Хорошо подходит для приложений с большими объемами данных и высокой нагрузкой на чтение. [PER01, SCA01]
3. **MSSQL (Microsoft SQL Server):** Масштабируемая реляционная СУБД с поддержкой сложных транзакций, мощной аналитики и интеграции с инструментами Microsoft. Подходит для приложений, требующих высокой надежности, безопасности и глубокой интеграции с другими продуктами Microsoft. [SCA02, SEC03]

- **NoSQL**
1. **MongoDB:** Документо-ориентированная NoSQL база данных, обеспечивающая гибкость в работе с полуструктурированными данными и возможностью горизонтального масштабирования. Идеально подходит для хранения данных о транспортных средствах, отзывах и других неструктурированных данных, которые могут изменяться. [SCA03, PER02]
2. **Cassandra:** Распределенная NoSQL база данных, оптимизированная для обработки большого количества записей с высокой доступностью и отказоустойчивостью. Подходит для систем с высокой нагрузкой, где необходимо быстро записывать и читать большие объемы данных, например, в случае с большим количеством пользователей и бронирований. [SCA02, PER01]
3. **Redis:** База данных на основе ключ-значение, подходящая для кэширования и быстрого доступа к данным. Используется для хранения временных данных, например, сессий пользователей, кэширования результатов поиска и других часто запрашиваемых данных. [PER03, SCA01]
4. **ClickHouse:** ClickHouse оптимизирован для аналитических запросов и может обрабатывать большие объемы данных с высокой скоростью. Это особенно полезно для сложных отчетов, аналитики пользовательского поведения и обработки большого количества отзывов. [PER02, SCA02]

**Решение:**

Выбрана комбинация PostgreSQL, Redis и ClickHouse.

**Обоснование:**

- **PostgreSQL:**
1. **Поддержка транзакций:** PostgreSQL обеспечит надежность и целостность данных при выполнении операций с бронированиями и платежами, а также при управлении пользователями. [PER02, SEC03]
2. **Гибкость с JSON:** Возможность хранения данных в формате JSON в реляционной базе позволяет легко управлять гибридными данными (например, отзывами и некоторыми аспектами информации о транспортных средствах). [SCA03, PER02]
3. **Безопасность и надежность:** Хорошая поддержка механизмов безопасности, шифрования и управления доступом. [SEC01, SEC03]

- **ClickHouse:**
1. **Высокая производительность**: ClickHouse оптимизирован для аналитических запросов и может обрабатывать большие объемы данных с высокой скоростью. [PER02]
2. **Горизонтальное масштабирование:** ClickHouse поддерживает горизонтальное масштабирование, что делает его подходящим для обработки массивов данных, таких как логи или телеметрия транспортных средств. [SCA02]
3. **Аналитика больших данных:** ClickHouse будет использоваться для аналитических данных, таких как логи использования системы, данные о поведении пользователей и сложные отчеты. [PER02, SCA02]

- **Redis:**
1. **Кэширование:** Используется для кэширования данных, что позволяет уменьшить задержки при частом доступе к часто используемым данным, например, сессиям пользователей или результатам поиска. [PER03]
2. **Быстрый доступ к данным:** Позволяет мгновенно получать данные благодаря хранению в памяти. [PER03]
3. **Поддержка Pub/Sub:** Обеспечивает поддержку системы уведомлений и обмена сообщениями в реальном времени. [SCA01]
  
**Последствия:**

- PostgreSQL будет использоваться для транзакционных операций, ClickHouse — для аналитики, а Redis — для кэширования данных и обеспечения быстрого доступа. [PER02, SCA03]
- Потребуется настроить синхронизацию между PostgreSQL и Redis для кэширования данных и передачу данных в ClickHouse для аналитики. [SCA02, SCA01]
- Redis поможет снизить нагрузку на основное хранилище данных, обеспечивая быстрый доступ к часто запрашиваемым данным. [PER03, SCA01]
- Поддержка нескольких систем хранения данных требует дополнительных усилий для администрирования и мониторинга. [DUR01, SCA02]
