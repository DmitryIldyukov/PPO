**Дата:** 12 ноября 2024 г.

**Статус:** Принято

**Контекст:**
В рамках разработки системы аренды автомобилей требуется выбрать метод связи между микросервисами, учитывая такие факторы, как надежность, масштабируемость, производительность и гибкость. Важно выбрать подход, который обеспечит возможность масштабирования системы и адаптации к изменяющимся требованиям.

**Рассмотренные варианты:**

1. **Синхронные вызовы через HTTP/REST API:** Каждый микросервис взаимодействует с другими с помощью RESTful API. Вызовы происходят по стандарту HTTP, и каждый сервис отвечает на запросы других сервисов.
2. **Асинхронные вызовы через Message Broker (например, RabbitMQ):** Микросервисы взаимодействуют через очередь сообщений, отправляя и получая данные в асинхронном режиме, что позволяет не блокировать сервисы при ожидании ответа.
3. **gRPC (Google Remote Procedure Call):** Использование gRPC для связи между микросервисами, что позволяет повысить производительность за счет двоичного формата сообщений и поддерживает синхронные и асинхронные вызовы.

**Решение:**
Выбрана асинхронная связь через Message Broker (RabbitMQ).

**Обоснование:**

1. **Масштабируемость:** Асинхронные вызовы через очередь сообщений позволяют системе обрабатывать большое количество запросов без блокировки сервисов. Это особенно важно для микросервисных архитектур, где нагрузка может значительно варьироваться. [AVA03]
2. **Надежность:** RabbitMQ поддерживает механизмы гарантированного доставки сообщений, что повышает надежность взаимодействия между сервисами. В случае временной недоступности одного из микросервисов сообщения не теряются и могут быть обработаны позже.
3. **Отказоустойчивость:** Асинхронная модель позволяет микросервисам продолжать работу, даже если один из сервисов временно не доступен. Это повышает устойчивость системы в целом. [AVA01, AVA02]
4. **Гибкость:** Использование RabbitMQ предоставляет гибкость в том, как и когда обработать данные. Сервисы могут работать в фоновом режиме, обрабатывая сообщения в удобное время.
5. **Декомпозиция:** Асинхронная связь позволяет улучшить распределение задач и нагрузку между микросервисами, минимизируя прямые зависимости между ними.

**Последствия:**

- Все микросервисы будут настроены на работу с RabbitMQ для обмена сообщениями.
- Потребуется внедрение механизмов обработки сообщений (производитель/потребитель), а также отслеживание состояния очередей для управления потоком данных.
- Для контроля за доставкой и обработкой сообщений потребуется интеграция с мониторинговыми инструментами, чтобы выявлять и решать возможные проблемы с очередями и потерями сообщений.
- Команда разработчиков должна быть обучена работе с очередями сообщений и их конфигурацией, а также управлению ошибками в асинхронной среде.